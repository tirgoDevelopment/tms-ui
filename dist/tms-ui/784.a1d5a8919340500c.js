"use strict";(self.webpackChunkfuse=self.webpackChunkfuse||[]).push([[784],{784:(Q,g,n)=>{n.r(g),n.d(g,{default:()=>N});var p=n(4755),t=n(2223),u=n(9401),l=n(1728),c=n(9114),C=n(9609),m=n(8467),f=n(2480),T=n(3844),v=n(3648),a=n(5580),y=n(8657),b=n(1292),A=n(1217),F=n(430),E=n(7406),Z=n(1709),x=n(8951);function w(s,h){1&s&&(t.TgZ(0,"span"),t._uU(1,"\u041e\u0442\u043f\u0440\u0430\u0432\u0438\u0442\u044c"),t.qZA())}function I(s,h){1&s&&t._UZ(0,"mat-progress-spinner",13),2&s&&t.Q6J("diameter",24)("mode","indeterminate")}let J=(()=>{class s{constructor(o,i,e,r,d){this.data=o,this.cdr=i,this.dialogRef=e,this.router=r,this.authService=d,this.toastr=(0,t.f3M)(v._W),this.loading=!1,this.countdown=119,this.isCodeExpired=!1,this.codeEntered=!1,this.email=""}ngOnInit(){this.email=this.data.email,this.startCountdown()}sendVerifyedCode(){this.onCodeCompleted(this.verifyCode)}retrySms(){this.loading=!0,this.authService.sendEmail({email:this.email}).subscribe(o=>{o.success&&(this.loading=!1,this.isCodeExpired=!1,this.countdown=119,this.startCountdown())})}startCountdown(){this.intervalId=setInterval(()=>{this.countdown>=0?(this.formatTime(this.countdown),this.countdown--):(this.stopCountdown(),this.isCodeExpired=!0)},1e3)}stopCountdown(){clearInterval(this.intervalId)}formatTime(o){const i=Math.floor(o/60),e=o%60;this.count=`${"0"+i}:${e<10?"0":""}${e}`,this.cdr.detectChanges()}closeModal(){this.dialogRef.close()}onCodeChanged(o){this.codeEntered=6==o.length,this.verifyCode=o}onCodeCompleted(o){this.verifyCode=o,this.codeEntered&&!this.isCodeExpired?this.authService.verifyCode({email:this.email,code:+o}).subscribe(i=>{i.success?(this.loading=!1,this.router.navigate(["auth/reset-password"],{queryParams:{email:this.email}}),this.dialogRef.close()):"Code is Invalid"==i.errors[0]&&(this.loading=!1,this.toastr.error("\u041f\u0430\u0440\u043e\u043b\u044c \u043d\u0435 \u0441\u043e\u0432\u043f\u0430\u0434\u0430\u0435\u0442"))}):this.isCodeExpired&&(this.loading=!1,this.toastr.error("\u0421\u0440\u043e\u043a \u0434\u0435\u0439\u0441\u0442\u0432\u0438\u044f SMS-\u043a\u043e\u0434\u0430 \u0438\u0441\u0442\u0435\u043a. \u041f\u043e\u0436\u0430\u043b\u0443\u0439\u0441\u0442\u0430, \u0437\u0430\u043f\u0440\u043e\u0441\u0438\u0442\u0435 \u043d\u043e\u0432\u044b\u0439."))}static#t=this.\u0275fac=function(i){return new(i||s)(t.Y36(a.WI),t.Y36(t.sBO),t.Y36(a.so),t.Y36(f.F0),t.Y36(x.e))};static#e=this.\u0275cmp=t.Xpm({type:s,selectors:[["verification-code"]],hostAttrs:[1,"verification-code-forgot"],standalone:!0,features:[t.jDz],decls:20,vars:9,consts:[["align","end"],["svgIcon","heroicons_outline:x-mark",1,"cursor-pointer",3,"click"],[1,"font-bold","text-3xl","flex","justify-center"],[1,"mat-typography","m-auto"],[1,"flex","justify-center"],[1,"text-center"],[3,"disabled","isCodeHidden","codeLength","codeChanged","codeCompleted"],["align","center"],["mat-flat-button","",1,"fuse-mat-button-large","dark","w-full","mt-6",3,"disabled","color","click"],[4,"ngIf"],[3,"diameter","mode",4,"ngIf"],[1,"inline-flex","items-center","justify-between","w-full","mt-4"],["disabled","loading",1,"text-md","font-medium","m-auto","cursor-pointer",3,"click"],[3,"diameter","mode"]],template:function(i,e){1&i&&(t.TgZ(0,"div",0)(1,"mat-icon",1),t.NdJ("click",function(){return e.closeModal()}),t.qZA()(),t.TgZ(2,"div",2),t._uU(3,"\u041f\u041e\u0414\u0422\u0412\u0415\u0420\u0416\u0414\u0415\u041d\u0418\u0415"),t.qZA(),t.TgZ(4,"mat-dialog-content",3)(5,"div",4),t._uU(6,"\u0412\u0432\u0435\u0434\u0438\u0442\u0435 6 \u0437\u043d\u0430\u0447\u043d\u044b\u0439 \u043a\u043e\u0434 \u043e\u0442\u043f\u0440\u0430\u0432\u043b\u0435\u043d \u043d\u0430 \u044d\u043b\u0435\u043a\u0442\u0440\u043e\u043d\u043d\u044b\u0439 \u0430\u0434\u0440\u0435\u0441 "),t.qZA(),t.TgZ(7,"div",5)(8,"b"),t._uU(9),t.qZA()(),t.TgZ(10,"code-input",6),t.NdJ("codeChanged",function(d){return e.onCodeChanged(d)})("codeCompleted",function(d){return e.onCodeCompleted(d)}),t.qZA()(),t.TgZ(11,"mat-dialog-actions",7)(12,"div"),t._uU(13),t.qZA(),t.TgZ(14,"button",8),t.NdJ("click",function(){return e.sendVerifyedCode()}),t.YNc(15,w,2,0,"span",9),t.YNc(16,I,1,2,"mat-progress-spinner",10),t.qZA(),t.TgZ(17,"div",11)(18,"a",12),t.NdJ("click",function(){return e.retrySms()}),t._uU(19,"\u0417\u0430\u043f\u0440\u043e\u0441\u0438\u0442\u044c \u0435\u0449\u0435 \u0440\u0430\u0437"),t.qZA()()()),2&i&&(t.xp6(9),t.Oqu(e.email),t.xp6(1),t.Q6J("disabled",e.loading)("isCodeHidden",!1)("codeLength",6),t.xp6(3),t.Oqu(e.count?e.count:"01:59"),t.xp6(1),t.Q6J("disabled",e.loading||!e.codeEntered)("color","primary"),t.xp6(1),t.Q6J("ngIf",!e.loading),t.xp6(1),t.Q6J("ngIf",e.loading))},dependencies:[Z.oY,Z.Oz,p.O5,m.Cq,m.Ou,l.ot,l.lW,F.Ps,F.Hw,u.UX,u.u5,y.Ky,b.p9,A.si,E.Tx,a.Is,a.xY,a.H8],styles:[".mat-mdc-dialog-container .mdc-dialog__surface{max-width:500px!important}\n"],encapsulation:2,changeDetection:0})}return s})();const Y=["forgotPasswordNgForm"];function D(s,h){1&s&&(t.TgZ(0,"span"),t._uU(1," \u041e\u0442\u043f\u0440\u0430\u0432\u0438\u0442\u044c "),t.qZA())}function S(s,h){1&s&&t._UZ(0,"mat-progress-spinner",14),2&s&&t.Q6J("diameter",24)("mode","indeterminate")}const U=function(){return["/auth/sign-in"]},N=[{path:"",component:(()=>{class s{constructor(o,i,e,r){this.authService=o,this.formBuilder=i,this.dialog=e,this.router=r,this.toastr=(0,t.f3M)(v._W)}ngOnInit(){this.form=this.formBuilder.group({email:["",[u.kI.required,u.kI.email]]})}sendCode(){""==this.form.value.email?this.toastr.error("\u0412\u0432\u0435\u0434\u0438\u0442\u0435 \u044d\u043b\u0435\u043a\u0442\u0440\u043e\u043d\u043d\u044b\u0439 \u043f\u043e\u0447\u0442\u0430"):(this.form.disable(),this.authService.sendEmail({email:this.form.value.email}).subscribe(o=>{o.success?(this.toastr.success("Sms-\u043a\u043e\u0434 \u0431\u0443\u0434\u0435\u0442 \u043e\u0442\u043f\u0440\u0430\u0432\u043b\u0435\u043d \u043d\u0430 \u0432\u0430\u0448\u0443 \u044d\u043b\u0435\u043a\u0442\u0440\u043e\u043d\u043d\u0443\u044e \u043f\u043e\u0447\u0442\u0443"),this.showVerifyCode(this.form.value.email)):"createFailed"==o.messages[0]&&(this.toastr.error("\u0410\u0434\u0440\u0435\u0441 \u044d\u043b\u0435\u043a\u0442\u0440\u043e\u043d\u043d\u043e\u0439 \u043f\u043e\u0447\u0442\u044b \u043d\u0435 \u043d\u0430\u0439\u0434\u0435\u043d"),this.form.enable())},o=>{"email must be an email"==o.error.message&&(this.toastr.error("\u041d\u0435\u0432\u0435\u0440\u043d\u044b\u0439 \u0444\u043e\u0440\u043c\u0430\u0442 \u044d\u043b\u0435\u043a\u0442\u0440\u043e\u043d\u043d\u043e\u0439 \u043f\u043e\u0447\u0442\u044b"),this.form.enable())}))}showVerifyCode(o){this.dialog.open(J,{autoFocus:!1,disableClose:!0,data:{email:o}}).afterClosed().subscribe(e=>{this.form.enable()})}static#t=this.\u0275fac=function(i){return new(i||s)(t.Y36(x.e),t.Y36(u.QS),t.Y36(a.uw),t.Y36(f.F0))};static#e=this.\u0275cmp=t.Xpm({type:s,selectors:[["auth-forgot-password"]],viewQuery:function(i,e){if(1&i&&t.Gf(Y,5),2&i){let r;t.iGM(r=t.CRH())&&(e.ngForm=r.first)}},standalone:!0,features:[t.jDz],decls:18,vars:7,consts:[[1,"flex","justify-center","items-center","h-full","w-full"],[1,"login-contianer"],[1,"mt-10","p-8","login-card"],[1,"text-5xl","md:text-4xl","sm:text-3xl","font-extrabold","tracking-tight","leading-tight","text-center"],[1,"mt-8",3,"formGroup","onSubmit"],["ngForm","ngForm"],[1,"form-width"],[1,"w-full"],["matInput","","formControlName","email"],["mat-flat-button","",1,"fuse-mat-button-large","dark","w-full","mt-6",3,"color","disabled","click"],[4,"ngIf"],[3,"diameter","mode",4,"ngIf"],[1,"inline-flex","items-center","justify-between","w-full","mt-8"],[1,"text-md","font-medium","m-auto",3,"routerLink"],[3,"diameter","mode"]],template:function(i,e){1&i&&(t.TgZ(0,"div",0)(1,"div",1)(2,"div",2)(3,"div",3),t._uU(4," \u0417\u0430\u0431\u044b\u043b\u0438 \u043f\u0430\u0440\u043e\u043b\u044c"),t.qZA(),t.TgZ(5,"form",4,5),t.NdJ("onSubmit",function(){return e.sendCode()}),t.TgZ(7,"div",6)(8,"mat-form-field",7)(9,"mat-label"),t._uU(10,"\u042d\u043b\u0435\u043a\u0442\u0440\u043e\u043d\u043d\u044b\u0439 \u0430\u0434\u0440\u0435\u0441"),t.qZA(),t._UZ(11,"input",8),t.qZA()(),t.TgZ(12,"button",9),t.NdJ("click",function(){return e.sendCode()}),t.YNc(13,D,2,0,"span",10),t.YNc(14,S,1,2,"mat-progress-spinner",11),t.qZA(),t.TgZ(15,"div",12)(16,"a",13),t._uU(17,"\u0410\u0432\u0442\u043e\u0440\u0438\u0437\u0430\u0446\u0438\u044f "),t.qZA()()()()()()),2&i&&(t.xp6(5),t.Q6J("formGroup",e.form),t.xp6(7),t.Q6J("color","primary")("disabled",e.form.disabled),t.xp6(1),t.Q6J("ngIf",!e.form.disabled),t.xp6(1),t.Q6J("ngIf",e.form.disabled),t.xp6(2),t.Q6J("routerLink",t.DdM(6,U)))},dependencies:[p.O5,a.Is,u.u5,u._Y,u.Fj,u.JJ,u.JL,u.UX,u.sg,u.u,c.lN,c.KE,c.hX,C.c,C.Nt,l.ot,l.lW,m.Cq,m.Ou,f.rH],styles:[".login-contianer{width:485px;flex-shrink:0}.login-contianer .login-card{background:#E8E8E8;border-radius:30px}\n"],encapsulation:2,data:{animation:T.L}})}return s})()}]}}]);